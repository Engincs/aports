diff --git a/google/cloud/spanner/interval.cc b/google/cloud/spanner/interval.cc
index 5d00c36a78..4d83437d8e 100644
--- a/google/cloud/spanner/interval.cc
+++ b/google/cloud/spanner/interval.cc
@@ -351,6 +351,20 @@ StatusOr<Interval> Interval::ParseISO8601Interval(absl::string_view str) {
   bool negated = false;
 
   for (;;) {
+    // Check if we've exhausted all units in the current category
+    // BEFORE doing any pointer comparisons to avoid UB
+    if (units == units_end) {
+      // Try to transition from date units to time units
+      if (units_end == std::end(kISO8601DateUnitFactories)) {
+        if (absl::ConsumePrefix(&s, "T")) {
+          units = std::begin(kISO8601TimeUnitFactories);
+          units_end = std::end(kISO8601TimeUnitFactories);
+          expecting = kValue;
+          continue;
+        }
+      }
+      break;
+    }
     if (units == std::begin(kISO8601DateUnitFactories)) {
       negated = !absl::ConsumePrefix(&s, "+") && absl::ConsumePrefix(&s, "-");
       if (!absl::ConsumePrefix(&s, "P")) break;
@@ -362,7 +376,6 @@ StatusOr<Interval> Interval::ParseISO8601Interval(absl::string_view str) {
         expecting = kValue;
       }
     }
-    if (units == units_end) break;
     double vf;
     if (ParseDouble(s, vf, true, true)) {
       expecting = kUnit;
