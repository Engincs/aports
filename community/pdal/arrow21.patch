Patch-Source: https://github.com/PDAL/PDAL/commit/860420bdaa4e4b44d3255d55b73950327ab90407
Patch-Source: https://github.com/PDAL/PDAL/commit/356826c20607b5db2e4e46cd8fb894b413553adf

--- a/plugins/arrow/io/ArrowReader.cpp
+++ b/plugins/arrow/io/ArrowReader.cpp
@@ -312,7 +312,27 @@ void ArrowReader::initialize()
 
 
 
+#if ARROW_VERSION_MAJOR >= 21
+        auto reader_result = parquet::arrow::OpenFile(m_file, m_pool);
+        if (!reader_result.ok())
+        {
+            std::stringstream msg;
+            msg << "Unable to open file '" << m_filename << "' with message '"
+                << reader_result.status().ToString() << "'";
+            throwError(msg.str());
+        }
+        m_arrow_reader = std::move(reader_result).ValueOrDie();
+#else
         auto pOpenStatus = parquet::arrow::OpenFile(m_file, m_pool, &m_arrow_reader);
+        if (!pOpenStatus.ok())
+        {
+            std::stringstream msg;
+            msg << "Unable to open file '" << m_filename << "' with message '"
+                << pOpenStatus.ToString() <<"'";
+            throwError(msg.str());
+        }
+#endif
+
 
         const auto metadata = m_arrow_reader->parquet_reader()->metadata();
         loadParquetGeoMetadata(metadata->key_value_metadata());
--- a/plugins/arrow/io/ArrowWriter.cpp
+++ b/plugins/arrow/io/ArrowWriter.cpp
@@ -523,7 +523,11 @@ void ArrowWriter::flushBatch()
 
     if (m_formatType == arrowsupport::Parquet)
     {
+#if ARROW_VERSION_MAJOR >= 20
+        auto result = m_parquetFileWriter->NewRowGroup();
+#else
         auto result = m_parquetFileWriter->NewRowGroup(m_batchSize);
+#endif
         if (!result.ok())
             throwError("Unable to make NewRowGroup: " + result.ToString());
 
