maintainer="Maarten van Gompel <proycon@anaproy.nl>"
pkgname=rivercarro
pkgver=0.5.0_git20250822
_commit=88d50c6d6d344afe4a82554f3db6e2e8b57e70c3
pkgrel=0
pkgdesc="A layout generator for river Wayland compositor, fork of rivertile"
url="https://git.sr.ht/~novakane/rivercarro"
arch="x86_64 aarch64" # limited by zig aport
license="GPL-3.0-only"
makedepends="
	libevdev-dev
	libxkbcommon-dev
	pixman-dev
	scdoc
	wayland-dev
	wayland-protocols
	wlroots0.18-dev
	zig
	"
options="!check net"
subpackages="
	$pkgname-doc
"
source="
	$pkgname-$_commit.tar.gz::https://git.sr.ht/~novakane/rivercarro/archive/$_commit.tar.gz
	"
builddir="$srcdir/$pkgname-$_commit"

# We may want other than "baseline" for other targets, when enabled by zig
case "$CARCH" in
	aarch64|x86_64) _cputarget=baseline ;;
esac

build() {
	# This installs it to $builddir/out
	DESTDIR="$builddir/out" zig build \
		-Doptimize=ReleaseSafe \
		--prefix /usr install \
		${_cputarget:+-Dcpu="$_cputarget"}
}

package() {
	mkdir -p "$pkgdir"
	cp -r out/* "$pkgdir"
	install -Dm644 "doc/$pkgname.1" -t "$pkgdir/usr/share/man/man1"
}


sha512sums="
f020bed4e0e1a67a311f5192329dec9169db78294cba5dfe34e1c0946f81fce1c180317feb002f1489e339a58d7ffd00d48fb85fb15d0a46be59d04e4218e57e  rivercarro-88d50c6d6d344afe4a82554f3db6e2e8b57e70c3.tar.gz
"
