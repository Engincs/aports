# Contributor: NeYurii <neyuriizkh@proton.me>
# Maintainer: NeYurii <neyuriizkh@proton.me>
pkgname=hyprsunset
pkgver=0.3.2
pkgrel=0
pkgdesc="Application to enable a blue-light filter on Hyprland"
url="https://wiki.hypr.land/Hypr-Ecosystem/hyprsunset"
arch="all"
license="BSD-3-Clause"
makedepends="
	cmake
	samurai
	hyprwayland-scanner
	wayland-dev
	wayland-protocols
	hyprland-protocols
	hyprutils-dev
	hyprlang-dev
	sdbus-cpp-dev
"
options="!check" # currently there are no tests
subpackages="$pkgname-doc $pkgname-openrc"
source="
	$pkgname-$pkgver.tar.gz::https://github.com/hyprwm/hyprsunset/archive/refs/tags/v$pkgver.tar.gz
	hyprsunset.initd
"

build() {
	cmake -S . -B ./build -G Ninja \
		-DCMAKE_BUILD_TYPE:STRING=Release \
		-DCMAKE_INSTALL_LIBDIR=lib \
		-DCMAKE_INSTALL_PREFIX:PATH=/usr

	cmake --build ./build --config Release
}

package() {
	DESTDIR="$pkgdir" cmake --install build
	rm -r "$pkgdir"/usr/lib/systemd

	install -Dm755 "$srcdir"/hyprsunset.initd "$pkgdir"/etc/user/init.d/hyprsunset

	install -Dm0644 -t "$pkgdir"/usr/share/licenses/"$pkgname" LICENSE
}

sha512sums="
02bde90463da6598726ee1d593945e3b34fa197b873f7be3025a250828c53d58a72c8973fc20740047fdd517e405cf5082ed1d3176f7fdc0503862888460469f  hyprsunset-0.3.2.tar.gz
13256f37d39ea4d0efade0da4c6f382687bdbf3f0ef1707dad7e7539304f05f2b184ef5540e9b38e347f871b4bad868dbcc072b6e83e8e30e7d2d558c7e48a8a  hyprsunset.initd
"
