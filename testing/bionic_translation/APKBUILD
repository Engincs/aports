maintainer="Bart Ribbers <bribbers@disroot.org>"
pkgname=bionic_translation
pkgver=0_git20250813
pkgrel=0
_commit="7c070d363e766ee2bc0e08440f9e76809ed1758c"
pkgdesc="A set of libraries for loading bionic-linked .so files on musl/glibc"
url="https://gitlab.com/android_translation_layer/bionic_translation"
arch="x86_64 aarch64 armv7 x86"
license="Apache-2.0"
makedepends="
	elfutils-dev
	libbsd-dev
	libunwind-dev
	mesa-dev
	meson
	samurai
	"
subpackages="$pkgname-dev $pkgname-dbg"
source="https://gitlab.com/android_translation_layer/bionic_translation/-/archive/$_commit/bionic_translation-$_commit.tar.gz
	x86.patch
	"
builddir="$srcdir/bionic_translation-$_commit"

build() {
	abuild-meson \
		. output
	meson compile -C output
}

check() {
	meson test --print-errorlogs -C output
}

package() {
	DESTDIR="$pkgdir" meson install --no-rebuild -C output
}

sha512sums="
174ec8057eeccfa66f3091a5a21b9b56038350c9c9264b80dca5057371028367524785b85650a1b25bd5fa047fb07aed2cb5a58660ec292c059f4f77a66dc3ab  bionic_translation-7c070d363e766ee2bc0e08440f9e76809ed1758c.tar.gz
fad6da0a0808e4c15de63042ec700c3a6cf359d988b3f7affc40a3d111fc89a1adaaca14b01957e4b6fec8e750f273dffcf0cc23cfd46b738a6bd4e1dce4c192  x86.patch
"
